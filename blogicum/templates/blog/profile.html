{% extends "base.html" %}
{% block title %}Профиль пользователя {{ profile.username }}{% endblock %}
{% block content %}
  <h1>Профиль пользователя {{ profile.username }}</h1>
  
  <div class="mb-4">
    <p><strong>Имя:</strong> {{ profile.first_name }}</p>
    <p><strong>Фамилия:</strong> {{ profile.last_name }}</p>
    <p><strong>Email:</strong> {{ profile.email }}</p>
    <p><strong>Дата регистрации:</strong> {{ profile.date_joined|date:"d E Y" }}</p>
    <p><strong>Всего публикаций:</strong> {{ page_obj.paginator.count }}</p>
    
    {% if user == profile %}
      <div class="btn-group" role="group">
        <a href="{% url 'blog:edit_profile' %}" class="btn btn-primary">
          Редактировать профиль
        </a>
        <a href="{% url 'password_change' %}" class="btn btn-secondary">
          Изменить пароль
        </a>
      </div>
    {% endif %}
  </div>
  
  <h2 class="mb-4">Публикации пользователя</h2>
  
  {% for post in page_obj %}
    <article class="mb-5">
      <h3>{{ post.title }}</h3>
      <p class="text-muted">
        {{ post.pub_date|date:"d E Y" }}
      </p>
      {% if post.image %}
        <img src="{{ post.image.url }}" class="img-fluid mb-3" alt="{{ post.title }}" style="max-height: 300px;">
      {% endif %}
      <p>{{ post.text|truncatewords:50 }}</p>
      <p class="text-muted">Комментариев: ({{ post.comment_count }})</p>
      <a href="{% url 'blog:post_detail' post.id %}" class="btn btn-sm btn-primary">
        Читать далее
      </a>
      {% if user == post.author %}
        <a href="{% url 'blog:edit_post' post.id %}" class="btn btn-sm btn-secondary">
          Редактировать
        </a>
        <a href="{% url 'blog:delete_post' post.id %}" class="btn btn-sm btn-danger">
          Удалить
        </a>
      {% endif %}
    </article>
    {% if not forloop.last %}<hr>{% endif %}
  {% empty %}
    <p>У пользователя пока нет публикаций.</p>
  {% endfor %}
  
  {% include "includes/paginator.html" %}
{% endblock %}